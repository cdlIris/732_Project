{% extends "base.html" %}
{% block title %}Real-Time estimate{% endblock %}
{% block page_content %}
<!DOCTYPE html>
<html>
	<head>
    	<meta charset="utf-8"/>
    	<title>Real-Time Bitcoin Price in USD</title>
    	<script src='https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js'></script>
    	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	
	</head>
	<body>
        	<h2>Real-Time Bitcoin Price</h2>
        	<div style="width:700px;height=500px">
            	<canvas id="chart"></canvas>
            </div>
            <h2>Sample pie chart</h2>
            <div style="width:700px;height=500px">
            	<canvas id="pie_chart"></canvas>
            </div>
            <script>
                
                var ctx = document.getElementById("chart");
                var ctx2 = document.getElementById("pie_chart");
                var myChart = new Chart(ctx, {
                     type: 'line',
                     data: {
                         labels: [{% for item in labels %}
                                   "{{item}}",
                                  {% endfor %}],
                         datasets: [{
                             label: 'BTC/USD',
                             data: [{% for item in values %}
                                       {{item}},
                                     {% endfor %}],
                            //  backgroundColor: [
                            //      'rgba(255, 99, 132, 0.2)',
                            //      'rgba(54, 162, 235, 0.2)',
                            //      'rgba(255, 206, 86, 0.2)',
                            //      'rgba(75, 192, 192, 0.2)',
                            //      'rgba(153, 102, 255, 0.2)',
                            //      'rgba(255, 159, 64, 0.2)',
                            //      'rgba(255, 99, 132, 0.2)',
                            //      'rgba(54, 162, 235, 0.2)',
                            //      'rgba(255, 206, 86, 0.2)',
                            //      'rgba(75, 192, 192, 0.2)',
                            //      'rgba(153, 102, 255, 0.2)'
                            //  ],
                             borderColor: "#3e95cd",
                             fill: false
                         }]
                     },
                     options: {
                         scales: {
                             yAxes: [{
                                 ticks: {
                                     beginAtZero:false
                                 }
                             }]
                         }
                     }
                });
                var pieChart = new Chart(ctx2, {
                     type: 'pie',
                     data: {
                         labels: ['num1', 'num2'],
                         datasets: [{
                             data: [{% for item in proportion %}
                                       {{item}},
                                     {% endfor %}],
                             backgroundColor: [
                                 'rgba(255, 99, 132, 0.2)',
                                 'rgba(54, 162, 235, 0.2)'
                             ]
                         }]
                     }
                });
                var src_Labels = [];
                var src_Data = [];
                var src_Prop = [];
                setInterval(function(){
                     $.getJSON('/realtime/refreshData', {
                     }, function(data) {
                         src_Labels = data.sLabel;
                         src_Data = data.sData;
                         src_Prop = data.sProp;
                     });
                     if (src_Data.length!=0){
                        myChart.data.labels = src_Labels;
                        myChart.data.datasets[0].data = src_Data;
                        pieChart.data.datasets[0].data = src_Prop;
                        myChart.update();
                        pieChart.update();
                     }
                },1000);
                setInterval(function(){
                     $.getJSON('/realtime/refreshDecision', {
                     }, function(data) {
                         src_Prop = data.sProp;
                     });
                     if (src_Prop.length!=0){
                        pieChart.data.datasets[0].data = src_Prop;
                        pieChart.update();
                     }
                },1000);
             </script>
	</body>
</html>
{% endblock %}